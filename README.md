# Basic CI/CD

## Part 1. Настройка gitlab-runner

- Поднял виртуальную машину `Ubuntu Server 22.04 LTS`.

- Скачал и установил на виртуальную машину gitlab-runner командой `sudo apt install gitlab-runner`.

- Запустил gitlab-runner `sudo gitlab-runner start` и зарегистрировал его для использования в текущем проекте `sudo gitlab-runner register`. Подключил репозиторий, добавил токен, описание и теги.

## Part 2. Сборка

### Напиши этап для CI по сборке приложений из проекта C2_SimpleBashUtils.

- В файле gitlab-ci.yml добавил этап запуска сборки через мейк файл из проекта по написанию своей реализацию `cat` и `grep`.

- Файлы, полученные после сборки (артефакты), сохранил в произвольную директорию со сроком хранения 30 дней.

  ![build_job](./img/01.png)<br/>
  ![build_job_status](./img/02.png)<br/>
  ![build_job_gitlab](./img/03.png)<br/>

## Part 3. Тест кодстайла

### Напиши этап для CI, который запускает скрипт кодстайла (clang-format)

- Если кодстайл не прошел, то пайплайн «зафейлится».

- В пайплайне отобразил вывод утилиты clang-format.

  ![clang-format](./img/04.png)<br/>
  ![clang-format_failed](./img/05.png)<br/>
  ![clang-format_success](./img/06.png)<br/>

## Part 4. Интеграционные тесты

### Напиши этап для CI, который запускает твои интеграционные тесты из того же проекта.

- Этот этап запустится автоматически только при условии, что сборка и тест кодстайла прошли успешно.

- Если тесты не прошли, то пайплайн «зафейлится».

- В пайплайне отобразил вывод, что интеграционные тесты успешно прошли/провалились.

  ![test](./img/07.png)<br/>
  ![test_failed](./img/08.png)<br/>
  ![test_success](./img/09.png)<br/>
  ![test_gitlab](./img/10.png)<br/>


 

## Part 5. Этап деплоя

- Поднял вторую виртуальную машину `Ubuntu Server 22.04 LTS`.

- Написал этап для CD, который «разворачивает» проект на другой виртуальной машине.

- Запустил этот этап вручную потому, что все предыдущие этапы прошли успешно.

- Написал bash-скрипт, который при помощи `ssh` и `scp` копирует файлы, полученные после сборки (артефакты), в директорию `/usr/local/bin` второй виртуальной машины.

- В файле `gitlab-ci.yml` добавил этап запуска написанного скрипта.

- В случае ошибки пайплайн «зафейлится».

  ![deploy](./img/11.png)<br/>
  ![deploy_script](./img/12.png)<br/>
  ![deploy_success](./img/13.png)<br/>
  ![deploy_gitlab](./img/14.png)<br/>
  ![deploy_artifacts](./img/15.png)<br/>



## Part 6. Дополнительно. Уведомления

- Настроил уведомления об успешном/неуспешном выполнении пайплайна через бота с именем `zoilanar DO6 CI/CD` в Telegram

  ![telegram_bot](./img/16.png)<br/> 
